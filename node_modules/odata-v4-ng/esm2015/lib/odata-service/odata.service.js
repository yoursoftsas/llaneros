/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,uselessCode} checked by tsc
 */
import { map } from 'rxjs/operators';
import { HttpClient, HttpHeaders } from '@angular/common/http';
import { Injectable } from '@angular/core';
import { ODataResponse } from '../odata-response/odata-response';
import { Utils } from '../utils/utils';
import { HttpOptions } from './http-options';
export class ODataService {
    /**
     * @param {?} http
     */
    constructor(http) {
        this.http = http;
    }
    /**
     * @param {?} odataQuery
     * @param {?=} httpOptions
     * @return {?}
     */
    get(odataQuery, httpOptions) {
        /** @type {?} */
        const url = odataQuery.toString();
        /** @type {?} */
        const options = this.createHttpOptions(httpOptions);
        return this.http.get(url, options).pipe(map(response => new ODataResponse(response)));
    }
    /**
     * @param {?} odataQuery
     * @param {?} body
     * @param {?=} httpOptions
     * @return {?}
     */
    post(odataQuery, body, httpOptions) {
        /** @type {?} */
        const url = odataQuery.toString();
        /** @type {?} */
        const options = this.createHttpOptions(httpOptions);
        return this.http.post(url, body, options).pipe(map(response => new ODataResponse(response)));
    }
    /**
     * @param {?} odataQuery
     * @param {?} body
     * @param {?=} etag
     * @param {?=} httpOptions
     * @return {?}
     */
    patch(odataQuery, body, etag, httpOptions) {
        /** @type {?} */
        const url = odataQuery.toString();
        /** @type {?} */
        let options = this.createHttpOptions(httpOptions);
        options = this.mergeETag(options, etag);
        return this.http.patch(url, body, options).pipe(map(response => new ODataResponse(response)));
    }
    /**
     * @param {?} odataQuery
     * @param {?} body
     * @param {?=} etag
     * @param {?=} httpOptions
     * @return {?}
     */
    put(odataQuery, body, etag, httpOptions) {
        /** @type {?} */
        const url = odataQuery.toString();
        /** @type {?} */
        let options = this.createHttpOptions(httpOptions);
        options = this.mergeETag(options, etag);
        return this.http.put(url, body, options).pipe(map(response => new ODataResponse(response)));
    }
    /**
     * @param {?} odataQuery
     * @param {?=} etag
     * @param {?=} httpOptions
     * @return {?}
     */
    delete(odataQuery, etag, httpOptions) {
        /** @type {?} */
        const url = odataQuery.toString();
        /** @type {?} */
        let options = this.createHttpOptions(httpOptions);
        options = this.mergeETag(options, etag);
        return this.http.delete(url, options).pipe(map(response => new ODataResponse(response)));
    }
    /**
     * @param {?} httpOptions
     * @return {?}
     */
    createHttpOptions(httpOptions) {
        if (httpOptions instanceof HttpOptions) {
            return httpOptions;
        }
        return Object.assign(new HttpOptions(), httpOptions);
    }
    /**
     * @param {?} httpOptions
     * @param {?} etag
     * @return {?}
     */
    mergeETag(httpOptions, etag) {
        if (Utils.isNullOrUndefined(etag)) {
            return httpOptions;
        }
        if (Utils.isNullOrUndefined(httpOptions)) {
            httpOptions = new HttpOptions();
        }
        if (Utils.isNullOrUndefined(httpOptions.headers)) {
            httpOptions.headers = new HttpHeaders();
        }
        httpOptions.headers[ODataService.IF_MATCH_HEADER] = etag;
        return httpOptions;
    }
}
ODataService.IF_MATCH_HEADER = 'If-Match';
ODataService.decorators = [
    { type: Injectable },
];
/** @nocollapse */
ODataService.ctorParameters = () => [
    { type: HttpClient }
];
if (false) {
    /** @type {?} */
    ODataService.IF_MATCH_HEADER;
    /** @type {?} */
    ODataService.prototype.http;
}

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoib2RhdGEuc2VydmljZS5qcyIsInNvdXJjZVJvb3QiOiJuZzovL29kYXRhLXY0LW5nLyIsInNvdXJjZXMiOlsibGliL29kYXRhLXNlcnZpY2Uvb2RhdGEuc2VydmljZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7O0FBQ0EsT0FBTyxFQUFDLEdBQUcsRUFBQyxNQUFNLGdCQUFnQixDQUFDO0FBR25DLE9BQU8sRUFBRSxVQUFVLEVBQUUsV0FBVyxFQUFFLE1BQU0sc0JBQXNCLENBQUM7QUFDL0QsT0FBTyxFQUFFLFVBQVUsRUFBRSxNQUFNLGVBQWUsQ0FBQztBQUszQyxPQUFPLEVBQUUsYUFBYSxFQUFFLE1BQU0sa0NBQWtDLENBQUM7QUFDakUsT0FBTyxFQUFFLEtBQUssRUFBRSxNQUFNLGdCQUFnQixDQUFDO0FBQ3ZDLE9BQU8sRUFBRSxXQUFXLEVBQWdCLE1BQU0sZ0JBQWdCLENBQUM7QUFHM0QsTUFBTTs7OztJQUdKLFlBQW9CLElBQWdCO1FBQWhCLFNBQUksR0FBSixJQUFJLENBQVk7S0FBSzs7Ozs7O0lBRXpDLEdBQUcsQ0FBQyxVQUFzQixFQUFFLFdBQTBCOztRQUNwRCxNQUFNLEdBQUcsR0FBVyxVQUFVLENBQUMsUUFBUSxFQUFFLENBQUM7O1FBQzFDLE1BQU0sT0FBTyxHQUFnQixJQUFJLENBQUMsaUJBQWlCLENBQUMsV0FBVyxDQUFDLENBQUM7UUFDakUsTUFBTSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLEdBQUcsRUFBRSxPQUFPLENBQUMsQ0FBQyxJQUFJLENBQ3JDLEdBQUcsQ0FBQyxRQUFRLENBQUMsRUFBRSxDQUFDLElBQUksYUFBYSxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUMsQ0FBQztLQUNqRDs7Ozs7OztJQUVELElBQUksQ0FBQyxVQUE4QixFQUFFLElBQVMsRUFBRSxXQUEwQjs7UUFDeEUsTUFBTSxHQUFHLEdBQVcsVUFBVSxDQUFDLFFBQVEsRUFBRSxDQUFDOztRQUMxQyxNQUFNLE9BQU8sR0FBZ0IsSUFB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RCxFQUFFLENBQUMsQ0FBQyxLQUFLLENBQUMsaUJBQWlCLENBQUMsV0FBVyxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsQ0FBQztZQUNqRCxXQUFXLENBQUMsT0FBTyxHQUFHLElBQUksV0FBVyxFQUFFLENBQUM7U0FDekM7UUFFRCxXQUFXLENBQUMsT0FBTyxDQUFDLFlBQVksQ0FBQyxlQUFlLENBQUMsR0FBRyxJQUFJLENBQUM7UUFFekQsTUFBTSxDQUFDLFdBQVcsQ0FBQztLQUNwQjs7K0JBL0R5QyxVQUFVOztZQUZyRCxVQUFVOzs7O1lBVkYsVUFBVSIsInNvdXJjZXNDb250ZW50IjpbIlxuaW1wb3J0IHttYXB9IGZyb20gJ3J4anMvb3BlcmF0b3JzJztcblxuXG5pbXBvcnQgeyBIdHRwQ2xpZW50LCBIdHRwSGVhZGVycyB9IGZyb20gJ0Bhbmd1bGFyL2NvbW1vbi9odHRwJztcbmltcG9ydCB7IEluamVjdGFibGUgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7IE9ic2VydmFibGUgfSBmcm9tICdyeGpzJztcblxuaW1wb3J0IHsgT0RhdGFRdWVyeSB9IGZyb20gJy4uL29kYXRhLXF1ZXJ5L29kYXRhLXF1ZXJ5JztcbmltcG9ydCB7IE9EYXRhUXVlcnlBYnN0cmFjdCB9IGZyb20gJy4uL29kYXRhLXF1ZXJ5L29kYXRhLXF1ZXJ5LWFic3RyYWN0JztcbmltcG9ydCB7IE9EYXRhUmVzcG9uc2UgfSBmcm9tICcuLi9vZGF0YS1yZXNwb25zZS9vZGF0YS1yZXNwb25zZSc7XG5pbXBvcnQgeyBVdGlscyB9IGZyb20gJy4uL3V0aWxzL3V0aWxzJztcbmltcG9ydCB7IEh0dHBPcHRpb25zLCBIdHRwT3B0aW9uc0kgfSBmcm9tICcuL2h0dHAtb3B0aW9ucyc7XG5cbkBJbmplY3RhYmxlKClcbmV4cG9ydCBjbGFzcyBPRGF0YVNlcnZpY2Uge1xuICBwcml2YXRlIHN0YXRpYyByZWFkb25seSBJRl9NQVRDSF9IRUFERVIgPSAnSWYtTWF0Y2gnO1xuXG4gIGNvbnN0cnVjdG9yKHByaXZhdGUgaHR0cDogSHR0cENsaWVudCkgeyB9XG5cbiAgZ2V0KG9kYXRhUXVlcnk6IE9EYXRhUXVlcnksIGh0dHBPcHRpb25zPzogSHR0cE9wdGlvbnNJKTogT2JzZXJ2YWJsZTxPRGF0YVJlc3BvbnNlPiB7XG4gICAgY29uc3QgdXJsOiBzdHJpbmcgPSBvZGF0YVF1ZXJ5LnRvU3RyaW5nKCk7XG4gICAgY29uc3Qgb3B0aW9uczogSHR0cE9wdGlvbnMgPSB0aGlzLmNyZWF0ZUh0dHBPcHRpb25zKGh0dHBPcHRpb25zKTtcbiAgICByZXR1cm4gdGhpcy5odHRwLmdldCh1cmwsIG9wdGlvbnMpLnBpcGUoXG4gICAgICBtYXAocmVzcG9uc2UgPT4gbmV3IE9EYXRhUmVzcG9uc2UocmVzcG9uc2UpKSk7XG4gIH1cblxuICBwb3N0KG9kYXRhUXVlcnk6IE9EYXRhUXVlcnlBYnN0cmFjdCwgYm9keTogYW55LCBodHRwT3B0aW9ucz86IEh0dHBPcHRpb25zSSk6IE9ic2VydmFibGU8T0RhdGFSZXNwb25zZT4ge1xuICAgIGNvbnN0IHVybDogc3RyaW5nID0gb2RhdGFRdWVyeS50b1N0cmluZygpO1xuICAgIGNvbnN0IG9wdGlvbnM6IEh0dHBPcHRpb25zID0gdGhpcy5jcmVhdGVIdHRwT3B0aW9ucyhodHRwT3B0aW9ucyk7XG4gICAgcmV0dXJuIHRoaXMuaHR0cC5wb3N0KHVybCwgYm9keSwgb3B0aW9ucykucGlwZShcbiAgICAgIG1hcChyZXNwb25zZSA9PiBuZXcgT0RhdGFSZXNwb25zZShyZXNwb25zZSkpKTtcbiAgfVxuXG4gIHBhdGNoKG9kYXRhUXVlcnk6IE9EYXRhUXVlcnksIGJvZHk6IGFueSwgZXRhZz86IHN0cmluZywgaHR0cE9wdGlvbnM/OiBIdHRwT3B0aW9uc0kpOiBPYnNlcnZhYmxlPE9EYXRhUmVzcG9uc2U+IHtcbiAgICBjb25zdCB1cmw6IHN0cmluZyA9IG9kYXRhUXVlcnkudG9TdHJpbmcoKTtcbiAgICBsZXQgb3B0aW9uczogSHR0cE9wdGlvbnMgPSB0aGlzLmNyZWF0ZUh0dHBPcHRpb25zKGh0dHBPcHRpb25zKTtcbiAgICBvcHRpb25zID0gdGhpcy5tZXJnZUVUYWcob3B0aW9ucywgZXRhZyk7XG4gICAgcmV0dXJuIHRoaXMuaHR0cC5wYXRjaCh1cmwsIGJvZHksIG9wdGlvbnMpLnBpcGUoXG4gICAgICBtYXAocmVzcG9uc2UgPT4gbmV3IE9EYXRhUmVzcG9uc2UocmVzcG9uc2UpKSk7XG4gIH1cblxuICBwdXQob2RhdGFRdWVyeTogT0RhdGFRdWVyeSwgYm9keTogYW55LCBldGFnPzogc3RyaW5nLCBodHRwT3B0aW9ucz86IEh0dHBPcHRpb25zSSk6IE9ic2VydmFibGU8T0RhdGFSZXNwb25zZT4ge1xuICAgIGNvbnN0IHVybDogc3RyaW5nID0gb2RhdGFRdWVyeS50b1N0cmluZygpO1xuICAgIGxldCBvcHRpb25zOiBIdHRwT3B0aW9ucyA9IHRoaXMuY3JlYXRlSHR0cE9wdGlvbnMoaHR0cE9wdGlvbnMpO1xuICAgIG9wdGlvbnMgPSB0aGlzLm1lcmdlRVRhZyhvcHRpb25zLCBldGFnKTtcbiAgICByZXR1cm4gdGhpcy5odHRwLnB1dCh1cmwsIGJvZHksIG9wdGlvbnMpLnBpcGUoXG4gICAgICBtYXAocmVzcG9uc2UgPT4gbmV3IE9EYXRhUmVzcG9uc2UocmVzcG9uc2UpKSk7XG4gIH1cblxuICBkZWxldGUob2RhdGFRdWVyeTogT0RhdGFRdWVyeSwgZXRhZz86IHN0cmluZywgaHR0cE9wdGlvbnM/OiBIdHRwT3B0aW9uc0kpOiBPYnNlcnZhYmxlPE9EYXRhUmVzcG9uc2U+IHtcbiAgICBjb25zdCB1cmw6IHN0cmluZyA9IG9kYXRhUXVlcnkudG9TdHJpbmcoKTtcbiAgICBsZXQgb3B0aW9uczogSHR0cE9wdGlvbnMgPSB0aGlzLmNyZWF0ZUh0dHBPcHRpb25zKGh0dHBPcHRpb25zKTtcbiAgICBvcHRpb25zID0gdGhpcy5tZXJnZUVUYWcob3B0aW9ucywgZXRhZyk7XG4gICAgcmV0dXJuIHRoaXMuaHR0cC5kZWxldGUodXJsLCBvcHRpb25zKS5waXBlKFxuICAgICAgbWFwKHJlc3BvbnNlID0+IG5ldyBPRGF0YVJlc3BvbnNlKHJlc3BvbnNlKSkpO1xuICB9XG5cbiAgcHJvdGVjdGVkIGNyZWF0ZUh0dHBPcHRpb25zKGh0dHBPcHRpb25zOiBIdHRwT3B0aW9uc0kpOiBIdHRwT3B0aW9ucyB7XG4gICAgaWYgKGh0dHBPcHRpb25zIGluc3RhbmNlb2YgSHR0cE9wdGlvbnMpIHtcbiAgICAgIHJldHVybiBodHRwT3B0aW9ucztcbiAgICB9XG4gICAgcmV0dXJuIE9iamVjdC5hc3NpZ24obmV3IEh0dHBPcHRpb25zKCksIGh0dHBPcHRpb25zKTtcbiAgfVxuXG4gIHByb3RlY3RlZCBtZXJnZUVUYWcoaHR0cE9wdGlvbnM6IEh0dHBPcHRpb25zLCBldGFnOiBzdHJpbmcpOiBIdHRwT3B0aW9ucyB7XG4gICAgaWYgKFV0aWxzLmlzTnVsbE9yVW5kZWZpbmVkKGV0YWcpKSB7XG4gICAgICByZXR1cm4gaHR0cE9wdGlvbnM7XG4gICAgfVxuICAgIGlmIChVdGlscy5pc051bGxPclVuZGVmaW5lZChodHRwT3B0aW9ucykpIHtcbiAgICAgIGh0dHBPcHRpb25zID0gbmV3IEh0dHBPcHRpb25zKCk7XG4gICAgfVxuICAgIGlmIChVdGlscy5pc051bGxPclVuZGVmaW5lZChodHRwT3B0aW9ucy5oZWFkZXJzKSkge1xuICAgICAgaHR0cE9wdGlvbnMuaGVhZGVycyA9IG5ldyBIdHRwSGVhZGVycygpO1xuICAgIH1cblxuICAgIGh0dHBPcHRpb25zLmhlYWRlcnNbT0RhdGFTZXJ2aWNlLklGX01BVENIX0hFQURFUl0gPSBldGFnO1xuXG4gICAgcmV0dXJuIGh0dHBPcHRpb25zO1xuICB9XG59XG4iXX0=