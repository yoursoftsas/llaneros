/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,uselessCode} checked by tsc
 */
import { FilterString } from './filter/filter-string';
import { Expand } from './expand';
import { Utils } from '../utils/utils';
import { Orderby } from './orderby';
export class QueryOptions {
    /**
     * @param {?} separator
     */
    constructor(separator) {
        Utils.requireNotNullNorUndefined(separator, 'separator');
        Utils.requireNotEmpty(separator, 'separator');
        this._separator = separator;
        this._select = null;
        this._filter = null;
        this._expand = null;
        this._orderby = null;
        this._search = null;
        this._skip = null;
        this._top = null;
        this._count = null;
        this._customOptions = null;
        this._format = null;
    }
    /**
     * @param {?} select
     * @return {?}
     */
    select(select) {
        if (Utils.isNullOrUndefined(select) || Utils.isEmpty(select)) {
            this._select = null;
        }
        else {
            this._select = typeof (select) === 'string' ? [select] : select;
        }
        return this;
    }
    /**
     * @param {?} filter
     * @return {?}
     */
    filter(filter) {
        if (Utils.isNullOrUndefined(filter) || Utils.isEmpty(filter)) {
            this._filter = null;
        }
        else {
            this._filter = typeof (filter) === 'string' ? new FilterString(filter) : filter;
        }
        return this;
    }
    /**
     * @param {?} expand
     * @return {?}
     */
    expand(expand) {
        if (Utils.isNullOrUndefined(expand) || Utils.isEmpty(expand)) {
            this._expand = null;
        }
        else {
            this._expand = typeof (expand) === 'string' ? [new Expand(expand)] : expand instanceof Expand ? [expand] : expand;
        }
        return this;
    }
    /**
     * @param {?} orderby
     * @return {?}
     */
    orderby(orderby) {
        if (Utils.isNullOrUndefined(orderby) || Utils.isEmpty(orderby)) {
            this._orderby = null;
        }
        else {
            this._orderby = typeof (orderby) === 'string' ? [new Orderby(orderby)] : orderby;
        }
        return this;
    }
    /**
     * @param {?} search
     * @return {?}
     */
    search(search) {
        this._search = search;
        return this;
    }
    /**
     * @param {?} skip
     * @return {?}
     */
    skip(skip) {
        Utils.requireNotNegative(skip, 'skip');
        this._skip = skip;
        return this;
    }
    /**
     * @param {?} top
     * @return {?}
     */
    top(top) {
        Utils.requireNotNegative(top, 'top');
        this._top = top;
        return this;
    }
    /**
     * @param {?} count
     * @return {?}
     */
    count(count) {
        this._count = count;
        return this;
    }
    /**
     * @param {?} format
     * @return {?}
     */
    format(format) {
        this._format = format;
        return this;
    }
    /**
     * @param {?} key
     * @param {?} value
     * @return {?}
     */
    customOption(key, value) {
        Utils.requireNotNullNorUndefined(key, 'key');
        if (Utils.isNullOrUndefined(this._customOptions)) {
            this._customOptions = new Map();
        }
        this._customOptions.set(key, value);
        return this;
    }
    /**
     * @return {?}
     */
    toString() {
        /** @type {?} */
        let queryOptions = '';
        // add select
        if (!Utils.isNullOrUndefined(this._select) && !Utils.isEmpty(this._select)) {
            queryOptions += '$select=';
            if (typeof (this._select) === 'string') {
                queryOptions += this._select;
            }
            else {
                queryOptions += Utils.toString(this._select);
            }
        }
        // add filter
        if (!Utils.isNullOrUndefined(this._filter) && !Utils.isEmpty(this._filter)) {
            if (queryOptions.length) {
                queryOptions += this._separator;
            }
            queryOptions += '$filter=' + encodeURIComponent(this._filter.toString());
        }
        // add expand
        if (!Utils.isNullOrUndefined(this._expand) && !Utils.isEmpty(this._expand)) {
            if (queryOptions.length) {
                queryOptions += this._separator;
            }
            queryOptions += '$expand=';
            if (typeof (this._expand) === 'string') {
                queryOptions += this._expand;
            }
            else {
                queryOptions += Utils.toString(this._expand);
            }
        }
        // add orderby
        if (!Utils.isNullOrUndefined(this._orderby) && !Utils.isEmpty(this._orderby)) {
            if (queryOptions.length) {
                queryOptions += this._separator;
            }
            queryOptions += '$orderby=';
            if (typeof (this._orderby) === 'string') {
                queryOptions += this._orderby;
            }
            else {
                queryOptions += Utils.toString(this._orderby);
            }
        }
        // add search
        if (!Utils.isNullOrUndefined(this._search) && !Utils.isEmpty(this._search)) {
            if (queryOptions.length) {
                queryOptions += this._separator;
            }
            queryOptions += '$search=' + encodeURIComponent(this._search.toString());
        }
        // add skip
        if (!Utils.isNullOrUndefined(this._skip) && !Utils.isEmpty(this._skip)) {
            if (queryOptions.length) {
                queryOptions += this._separator;
            }
            queryOptions += '$skip=' + this._skip;
        }
        // add top
        if (!Utils.isNullOrUndefined(this._top) && !Utils.isEmpty(this._top)) {
            if (queryOptions.length) {
                queryOptions += this._separator;
            }
            queryOptions += '$top=' + this._top;
        }
        // add count
        if (!Utils.isNullOrUndefined(this._count) && !Utils.isEmpty(this._count)) {
            if (queryOptions.length) {
                queryOptions += this._separator;
            }
            queryOptions += '$count=' + this._count;
        }
        // add custom query options
        if (Utils.isNotNullNorUndefined(this._customOptions) && this._customOptions.size > 0) {
            this._customOptions.forEach((value, key, map) => {
                if (Utils.isNotNullNorUndefined(key) && !Utils.isEmpty(key)
                    && Utils.isNotNullNorUndefined(value) && !Utils.isEmpty(value)) {
                    if (queryOptions.length) {
                        queryOptions += this._separator;
                    }
                    queryOptions += key + '=' + encodeURIComponent(value);
                }
            });
        }
        // add format
        if (!Utils.isNullOrUndefined(this._format) && !Utils.isEmpty(this._format)) {
            if (queryOptions.length) {
                queryOptions += this._separator;
            }
            queryOptions += '$format=' + this._format;
        }
        return queryOptions;
    }
    /**
     * @return {?}
     */
    isEmpty() {
        for (const key in this) {
            if (key === '_purpose' || key === '_separator') {
                continue;
            }
            if (this.hasOwnProperty(key) && !Utils.isEmpty(this[key])) {
                return false;
            }
        }
        return true;
    }
}
if (false) {
    /** @type {?} */
    QueryOptions.prototype._separator;
    /** @type {?} */
    QueryOptions.prototype._select;
    /** @type {?} */
    QueryOptions.prototype._filter;
    /** @type {?} */
    QueryOptions.prototype._expand;
    /** @type {?} */
    QueryOptions.prototype._orderby;
    /** @type {?} */
    QueryOptions.prototype._search;
    /** @type {?} */
    QueryOptions.prototype._skip;
    /** @type {?} */
    QueryOptions.prototype._top;
    /** @type {?} */
    QueryOptions.prototype._count;
    /** @type {?} */
    QueryOptions.prototype._customOptions;
    /** @type {?} */
    QueryOptions.prototype._format;
}

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicXVlcnktb3B0aW9ucy5qcyIsInNvdXJjZVJvb3QiOiJuZzovL29kYXRhLXY0LW5nLyIsInNvdXJjZXMiOlsibGliL3F1ZXJ5LW9wdGlvbnMvcXVlcnktb3B0aW9ucy50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7O0FBQUEsT0FBTyxFQUFFLFlBQVksRUFBRSxNQUFNLHdCQUF3QixDQUFDO0FBRXRELE9BQU8sRUFBRSxNQUFNLEVBQUUsTUFBTSxVQUFVLENBQUM7QUFDbEMsT0FBTyxFQUFFLEtBQUssRUFBRSxNQUFNLGdCQUFnQixDQUFDO0FBQ3ZDLE9BQU8sRUFBRSxPQUFPLEVBQUUsTUFBTSxXQUFXLENBQUM7QUFHcEMsTUFBTTs7OztJQWFKLFlBQVksU0FBaUI7UUFDM0IsS0FBSyxDQUFDLDBCQUEwQixDQUFDLFNBQVMsRUFBRSxXQUFXLENBQUMsQ0FBQztRQUN6RCxLQUFLLENBQUMsZUFBZSxDQUFDLFNBQVMsRUFBRSxXQUFXLENBQUMsQ0FBQztRQUM5QyxJQUFJLENBQUMsVUFBVSxHQUFHLFNBQVMsQ0FBQztRQUM1QixJQUFJLENBQUMsT0FBTyxHQUFHLElBQUksQ0FBQztRQUNwQixJQUFJLENBQUMsT0FBTyxHQUFHLElBQUksQ0FBQztRQUNwQixJQUFJLENBQUMsT0FBTyxHQUFHLElBQUksQ0FBQztRQUNwQixJQUFJLENBQUMsUUFBUSxHQUFHLElBQUksQ0FBQztRQUNyQixJQUFJLENBQUMsT0FBTyxHQUFHLElBQUksQ0FBQztRQUNwQixJQUFJLENBQUMsS0FBSyxHQUFHLElBQUksQ0FBQztRQUNsQixJQUFJLENBQUMsSUFBSSxHQUFHLElBQUksQ0FBQztRQUNqQixJQUFJLENBQUMsTUFBTSxHQUFHLElBQUksQ0FBQztRQUNuQixJQUFJLENBQUMsY0FBYyxHQUFHLElBQUksQ0FBQztRQUMzQixJQUFJLENBQUMsT0FBTyxHQUFHLElBQUksQ0FBQztLQUNyQjs7Ozs7SUFFRCxNQUFNLENBQUMsTUFBeUI7UUFDOUIsRUFBRSxDQUFDLENBQUMsS0FB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Iiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgRmlsdGVyU3RyaW5nIH0gZnJvbSAnLi9maWx0ZXIvZmlsdGVyLXN0cmluZyc7XG5pbXBvcnQgeyBGaWx0ZXIgfSBmcm9tICcuL2ZpbHRlci9maWx0ZXInO1xuaW1wb3J0IHsgRXhwYW5kIH0gZnJvbSAnLi9leHBhbmQnO1xuaW1wb3J0IHsgVXRpbHMgfSBmcm9tICcuLi91dGlscy91dGlscyc7XG5pbXBvcnQgeyBPcmRlcmJ5IH0gZnJvbSAnLi9vcmRlcmJ5JztcbmltcG9ydCB7IFNlYXJjaCB9IGZyb20gJy4vc2VhcmNoL3NlYXJjaCc7XG5cbmV4cG9ydCBjbGFzcyBRdWVyeU9wdGlvbnMge1xuICBwcml2YXRlIF9zZXBhcmF0b3I6IHN0cmluZztcbiAgcHJpdmF0ZSBfc2VsZWN0OiBzdHJpbmdbXTtcbiAgcHJpdmF0ZSBfZmlsdGVyOiBGaWx0ZXI7XG4gIHByaXZhdGUgX2V4cGFuZDogRXhwYW5kW107XG4gIHByaXZhdGUgX29yZGVyYnk6IE9yZGVyYnlbXTtcbiAgcHJpdmF0ZSBfc2VhcmNoOiBzdHJpbmcgfCBTZWFyY2g7XG4gIHByaXZhdGUgX3NraXA6IG51bWJlcjtcbiAgcHJpdmF0ZSBfdG9wOiBudW1iZXI7XG4gIHByaXZhdGUgX2NvdW50OiBib29sZWFuO1xuICBwcml2YXRlIF9jdXN0b21PcHRpb25zOiBNYXA8c3RyaW5nLCBzdHJpbmc+O1xuICBwcml2YXRlIF9mb3JtYXQ6IHN0cmluZztcblxuICBjb25zdHJ1Y3RvcihzZXBhcmF0b3I6IHN0cmluZykge1xuICAgIFV0aWxzLnJlcXVpcmVOb3ROdWxsTm9yVW5kZWZpbmVkKHNlcGFyYXRvciwgJ3NlcGFyYXRvcicpO1xuICAgIFV0aWxzLnJlcXVpcmVOb3RFbXB0eShzZXBhcmF0b3IsICdzZXBhcmF0b3InKTtcbiAgICB0aGlzLl9zZXBhcmF0b3IgPSBzZXBhcmF0b3I7XG4gICAgdGhpcy5fc2VsZWN0ID0gbnVsbDtcbiAgICB0aGlzLl9maWx0ZXIgPSBudWxsO1xuICAgIHRoaXMuX2V4cGFuZCA9IG51bGw7XG4gICAgdGhpcy5fb3JkZXJieSA9IG51bGw7XG4gICAgdGhpcy5fc2VhcmNoID0gbnVsbDtcbiAgICB0aGlzLl9za2lwID0gbnVsbDtcbiAgICB0aGlzLl90b3AgPSBudWxsO1xuICAgIHRoaXMuX2NvdW50ID0gbnVsbDtcbiAgICB0aGlzLl9jdXN0b21PcHRpb25zID0gbnVsbDtcbiAgICB0aGlzLl9mb3JtYXQgPSBudWxsO1xuICB9XG5cbiAgc2VsZWN0KHNlbGVjdDogc3RyaW5nIHwgc3RyaW5nW10pOiBRdWVyeU9wdGlvbnMge1xuICAgIGlmIChVdGlscy5pc051bGxPclVuZGVmaW5lZChzZWxlY3QpIHx8IFV0aWxzLmlzRW1wdHkoc2VsZWN0KSkge1xuICAgICAgdGhpcy5fc2VsZWN0ID0gbnVsbDtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5fc2VsZWN0ID0gdHlwZW9mIChzZWxlY3QpID09PSAnc3RyaW5nJyA/IFtzZWxlY3RdIDogc2VsZWN0O1xuICAgIH1cbiAgICByZXR1cm4gdGhpcztcbiAgfVxuXG4gIGZpbHRlcihmaWx0ZXI6IHN0cmluZyB8IEZpbHRlcik6IFF1ZXJ5T3B0aW9ucyB7XG4gICAgaWYgKFV0aWxzLmlzTnVsbE9yVW5kZWZpbmVkKGZpbHRlcikgfHwgVXRpbHMuaXNFbXB0eShmaWx0ZXIpKSB7XG4gICAgICB0aGlzLl9maWx0ZXIgPSBudWxsO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl9maWx0ZXIgPSB0eXBlb2YgKGZpbHRlcikgPT09ICdzdHJpbmcnID8gbmV3IEZpbHRlclN0cmluZyhmaWx0ZXIpIDogZmlsdGVyO1xuICAgIH1cbiAgICByZXR1cm4gdGhpcztcbiAgfVxuXG4gIGV4cGFuZChleHBhbmQ6IHN0cmluZyB8IEV4cGFuZCB8IEV4cGFuZFtdKTogUXVlcnlPcHRpb25zIHtcbiAgICBpZiAoVXRpbHMuaXNOdWxsT3JVbmRlZmluZWQoZXhwYW5kKSB8fCBVdGlscy5pc0VtcHR5KGV4cGFuZCkpIHtcbiAgICAgIHRoaXMuX2V4cGFuZCA9IG51bGw7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuX2V4cGFuZCA9IHR5cGVvZiAoZXhwYW5kKSA9PT0gJ3N0cmluZycgPyBbbmV3IEV4cGFuZChleHBhbmQpXSA6IGV4cGFuZCBpbnN0YW5jZW9mIEV4cGFuZCA/IFtleHBhbmRdIDogZXhwYW5kO1xuICAgIH1cbiAgICByZXR1cm4gdGhpcztcbiAgfVxuXG4gIG9yZGVyYnkob3JkZXJieTogc3RyaW5nIHwgT3JkZXJieVtdKTogUXVlcnlPcHRpb25zIHtcbiAgICBpZiAoVXRpbHMuaXNOdWxsT3JVbmRlZmluZWQob3JkZXJieSkgfHwgVXRpbHMuaXNFbXB0eShvcmRlcmJ5KSkge1xuICAgICAgdGhpcy5fb3JkZXJieSA9IG51bGw7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuX29yZGVyYnkgPSB0eXBlb2YgKG9yZGVyYnkpID09PSAnc3RyaW5nJyA/IFtuZXcgT3JkZXJieShvcmRlcmJ5KV0gOiBvcmRlcmJ5O1xuICAgIH1cbiAgICByZXR1cm4gdGhpcztcbiAgfVxuXG4gIHNlYXJjaChzZWFyY2g6IHN0cmluZyB8IFNlYXJjaCk6IFF1ZXJ5T3B0aW9ucyB7XG4gICAgdGhpcy5fc2VhcmNoID0gc2VhcmNoO1xuICAgIHJldHVybiB0aGlzO1xuICB9XG5cbiAgc2tpcChza2lwOiBudW1iZXIpOiBRdWVyeU9wdGlvbnMge1xuICAgIFV0aWxzLnJlcXVpcmVOb3ROZWdhdGl2ZShza2lwLCAnc2tpcCcpO1xuICAgIHRoaXMuX3NraXAgPSBza2lwO1xuICAgIHJldHVybiB0aGlzO1xuICB9XG5cbiAgdG9wKHRvcDogbnVtYmVyKTogUXVlcnlPcHRpb25zIHtcbiAgICBVdGlscy5yZXF1aXJlTm90TmVnYXRpdmUodG9wLCAndG9wJyk7XG4gICAgdGhpcy5fdG9wID0gdG9wO1xuICAgIHJldHVybiB0aGlzO1xuICB9XG5cbiAgY291bnQoY291bnQ6IGJvb2xlYW4pOiBRdWVyeU9wdGlvbnMge1xuICAgIHRoaXMuX2NvdW50ID0gY291bnQ7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cblxuICBmb3JtYXQoZm9ybWF0OiBzdHJpbmcpOiBRdWVyeU9wdGlvbnMge1xuICAgIHRoaXMuX2Zvcm1hdCA9IGZvcm1hdDtcbiAgICByZXR1cm4gdGhpcztcbiAgfVxuXG4gIGN1c3RvbU9wdGlvbihrZXk6IHN0cmluZywgdmFsdWU6IHN0cmluZykge1xuICAgIFV0aWxzLnJlcXVpcmVOb3ROdWxsTm9yVW5kZWZpbmVkKGtleSwgJ2tleScpO1xuICAgIGlmIChVdGlscy5pc051bGxPclVuZGVmaW5lZCh0aGlzLl9jdXN0b21PcHRpb25zKSkge1xuICAgICAgdGhpcy5fY3VzdG9tT3B0aW9ucyA9IG5ldyBNYXA8c3RyaW5nLCBzdHJpbmc+KCk7XG4gICAgfVxuICAgIHRoaXMuX2N1c3RvbU9wdGlvbnMuc2V0KGtleSwgdmFsdWUpO1xuICAgIHJldHVybiB0aGlzO1xuICB9XG5cbiAgdG9TdHJpbmcoKTogc3RyaW5nIHtcbiAgICAvLyBxdWVyeSBvcHRpb25zXG4gICAgbGV0IHF1ZXJ5T3B0aW9ucyA9ICcnO1xuXG4gICAgLy8gYWRkIHNlbGVjdFxuICAgIGlmICghVXRpbHMuaXNOdWxsT3JVbmRlZmluZWQodGhpcy5fc2VsZWN0KSAmJiAhVXRpbHMuaXNFbXB0eSh0aGlzLl9zZWxlY3QpKSB7XG4gICAgICBxdWVyeU9wdGlvbnMgKz0gJyRzZWxlY3Q9JztcbiAgICAgIGlmICh0eXBlb2YgKHRoaXMuX3NlbGVjdCkgPT09ICdzdHJpbmcnKSB7XG4gICAgICAgIHF1ZXJ5T3B0aW9ucyArPSB0aGlzLl9zZWxlY3Q7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBxdWVyeU9wdGlvbnMgKz0gVXRpbHMudG9TdHJpbmcodGhpcy5fc2VsZWN0KTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBhZGQgZmlsdGVyXG4gICAgaWYgKCFVdGlscy5pc051bGxPclVuZGVmaW5lZCh0aGlzLl9maWx0ZXIpICYmICFVdGlscy5pc0VtcHR5KHRoaXMuX2ZpbHRlcikpIHtcbiAgICAgIGlmIChxdWVyeU9wdGlvbnMubGVuZ3RoKSB7XG4gICAgICAgIHF1ZXJ5T3B0aW9ucyArPSB0aGlzLl9zZXBhcmF0b3I7XG4gICAgICB9XG4gICAgICBxdWVyeU9wdGlvbnMgKz0gJyRmaWx0ZXI9JyArIGVuY29kZVVSSUNvbXBvbmVudCh0aGlzLl9maWx0ZXIudG9TdHJpbmcoKSk7XG4gICAgfVxuXG4gICAgLy8gYWRkIGV4cGFuZFxuICAgIGlmICghVXRpbHMuaXNOdWxsT3JVbmRlZmluZWQodGhpcy5fZXhwYW5kKSAmJiAhVXRpbHMuaXNFbXB0eSh0aGlzLl9leHBhbmQpKSB7XG4gICAgICBpZiAocXVlcnlPcHRpb25zLmxlbmd0aCkge1xuICAgICAgICBxdWVyeU9wdGlvbnMgKz0gdGhpcy5fc2VwYXJhdG9yO1xuICAgICAgfVxuICAgICAgcXVlcnlPcHRpb25zICs9ICckZXhwYW5kPSc7XG4gICAgICBpZiAodHlwZW9mICh0aGlzLl9leHBhbmQpID09PSAnc3RyaW5nJykge1xuICAgICAgICBxdWVyeU9wdGlvbnMgKz0gdGhpcy5fZXhwYW5kO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcXVlcnlPcHRpb25zICs9IFV0aWxzLnRvU3RyaW5nKHRoaXMuX2V4cGFuZCk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8gYWRkIG9yZGVyYnlcbiAgICBpZiAoIVV0aWxzLmlzTnVsbE9yVW5kZWZpbmVkKHRoaXMuX29yZGVyYnkpICYmICFVdGlscy5pc0VtcHR5KHRoaXMuX29yZGVyYnkpKSB7XG4gICAgICBpZiAocXVlcnlPcHRpb25zLmxlbmd0aCkge1xuICAgICAgICBxdWVyeU9wdGlvbnMgKz0gdGhpcy5fc2VwYXJhdG9yO1xuICAgICAgfVxuICAgICAgcXVlcnlPcHRpb25zICs9ICckb3JkZXJieT0nO1xuICAgICAgaWYgKHR5cGVvZiAodGhpcy5fb3JkZXJieSkgPT09ICdzdHJpbmcnKSB7XG4gICAgICAgIHF1ZXJ5T3B0aW9ucyArPSB0aGlzLl9vcmRlcmJ5O1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcXVlcnlPcHRpb25zICs9IFV0aWxzLnRvU3RyaW5nKHRoaXMuX29yZGVyYnkpO1xuICAgICAgfVxuICAgIH1cblxuICAgIC8vIGFkZCBzZWFyY2hcbiAgICBpZiAoIVV0aWxzLmlzTnVsbE9yVW5kZWZpbmVkKHRoaXMuX3NlYXJjaCkgJiYgIVV0aWxzLmlzRW1wdHkodGhpcy5fc2VhcmNoKSkge1xuICAgICAgaWYgKHF1ZXJ5T3B0aW9ucy5sZW5ndGgpIHtcbiAgICAgICAgcXVlcnlPcHRpb25zICs9IHRoaXMuX3NlcGFyYXRvcjtcbiAgICAgIH1cbiAgICAgIHF1ZXJ5T3B0aW9ucyArPSAnJHNlYXJjaD0nICsgZW5jb2RlVVJJQ29tcG9uZW50KHRoaXMuX3NlYXJjaC50b1N0cmluZygpKTtcbiAgICB9XG5cbiAgICAvLyBhZGQgc2tpcFxuICAgIGlmICghVXRpbHMuaXNOdWxsT3JVbmRlZmluZWQodGhpcy5fc2tpcCkgJiYgIVV0aWxzLmlzRW1wdHkodGhpcy5fc2tpcCkpIHtcbiAgICAgIGlmIChxdWVyeU9wdGlvbnMubGVuZ3RoKSB7XG4gICAgICAgIHF1ZXJ5T3B0aW9ucyArPSB0aGlzLl9zZXBhcmF0b3I7XG4gICAgICB9XG4gICAgICBxdWVyeU9wdGlvbnMgKz0gJyRza2lwPScgKyB0aGlzLl9za2lwO1xuICAgIH1cblxuICAgIC8vIGFkZCB0b3BcbiAgICBpZiAoIVV0aWxzLmlzTnVsbE9yVW5kZWZpbmVkKHRoaXMuX3RvcCkgJiYgIVV0aWxzLmlzRW1wdHkodGhpcy5fdG9wKSkge1xuICAgICAgaWYgKHF1ZXJ5T3B0aW9ucy5sZW5ndGgpIHtcbiAgICAgICAgcXVlcnlPcHRpb25zICs9IHRoaXMuX3NlcGFyYXRvcjtcbiAgICAgIH1cbiAgICAgIHF1ZXJ5T3B0aW9ucyArPSAnJHRvcD0nICsgdGhpcy5fdG9wO1xuICAgIH1cblxuICAgIC8vIGFkZCBjb3VudFxuICAgIGlmICghVXRpbHMuaXNOdWxsT3JVbmRlZmluZWQodGhpcy5fY291bnQpICYmICFVdGlscy5pc0VtcHR5KHRoaXMuX2NvdW50KSkge1xuICAgICAgaWYgKHF1ZXJ5T3B0aW9ucy5sZW5ndGgpIHtcbiAgICAgICAgcXVlcnlPcHRpb25zICs9IHRoaXMuX3NlcGFyYXRvcjtcbiAgICAgIH1cbiAgICAgIHF1ZXJ5T3B0aW9ucyArPSAnJGNvdW50PScgKyB0aGlzLl9jb3VudDtcbiAgICB9XG5cbiAgICAvLyBhZGQgY3VzdG9tIHF1ZXJ5IG9wdGlvbnNcbiAgICBpZiAoVXRpbHMuaXNOb3ROdWxsTm9yVW5kZWZpbmVkKHRoaXMuX2N1c3RvbU9wdGlvbnMpICYmIHRoaXMuX2N1c3RvbU9wdGlvbnMuc2l6ZSA+IDApIHtcbiAgICAgIHRoaXMuX2N1c3RvbU9wdGlvbnMuZm9yRWFjaCgodmFsdWU6IHN0cmluZywga2V5OiBzdHJpbmcsIG1hcDogTWFwPHN0cmluZywgc3RyaW5nPikgPT4ge1xuICAgICAgICBpZiAoVXRpbHMuaXNOb3ROdWxsTm9yVW5kZWZpbmVkKGtleSkgJiYgIVV0aWxzLmlzRW1wdHkoa2V5KVxuICAgICAgICAgICYmIFV0aWxzLmlzTm90TnVsbE5vclVuZGVmaW5lZCh2YWx1ZSkgJiYgIVV0aWxzLmlzRW1wdHkodmFsdWUpKSB7XG4gICAgICAgICAgaWYgKHF1ZXJ5T3B0aW9ucy5sZW5ndGgpIHtcbiAgICAgICAgICAgIHF1ZXJ5T3B0aW9ucyArPSB0aGlzLl9zZXBhcmF0b3I7XG4gICAgICAgICAgfVxuICAgICAgICAgIHF1ZXJ5T3B0aW9ucyArPSBrZXkgKyAnPScgKyBlbmNvZGVVUklDb21wb25lbnQodmFsdWUpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICAvLyBhZGQgZm9ybWF0XG4gICAgaWYgKCFVdGlscy5pc051bGxPclVuZGVmaW5lZCh0aGlzLl9mb3JtYXQpICYmICFVdGlscy5pc0VtcHR5KHRoaXMuX2Zvcm1hdCkpIHtcbiAgICAgIGlmIChxdWVyeU9wdGlvbnMubGVuZ3RoKSB7XG4gICAgICAgIHF1ZXJ5T3B0aW9ucyArPSB0aGlzLl9zZXBhcmF0b3I7XG4gICAgICB9XG4gICAgICBxdWVyeU9wdGlvbnMgKz0gJyRmb3JtYXQ9JyArIHRoaXMuX2Zvcm1hdDtcbiAgICB9XG5cbiAgICByZXR1cm4gcXVlcnlPcHRpb25zO1xuICB9XG5cbiAgaXNFbXB0eSgpOiBib29sZWFuIHtcbiAgICBmb3IgKGNvbnN0IGtleSBpbiB0aGlzKSB7XG4gICAgICBpZiAoa2V5ID09PSAnX3B1cnBvc2UnIHx8IGtleSA9PT0gJ19zZXBhcmF0b3InKSB7XG4gICAgICAgIGNvbnRpbnVlO1xuICAgICAgfVxuICAgICAgaWYgKHRoaXMuaGFzT3duUHJvcGVydHkoa2V5KSAmJiAhVXRpbHMuaXNFbXB0eSh0aGlzW2tleV0pKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHRydWU7XG4gIH1cbn1cbiJdfQ==