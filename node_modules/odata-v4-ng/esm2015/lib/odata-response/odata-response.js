/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,uselessCode} checked by tsc
 */
import { Utils } from '../utils/utils';
import { EntitySet } from './entity-collection';
import { Metadata } from './metadata';
import { ODataResponseAbstract } from './odata-response-abstract';
import { ODataResponseBatch } from './odata-response-batch';
export class ODataResponse extends ODataResponseAbstract {
    /**
     * @param {?} httpResponse
     */
    constructor(httpResponse) {
        super(httpResponse);
    }
    /**
     * @return {?}
     */
    getBodyAsJson() {
        /** @type {?} */
        const contentType = this.getHttpResponse().headers.get('Content-Type');
        if (Utils.isNotNullNorUndefined(contentType) && contentType.includes('json')) {
            try {
                return JSON.parse(this.getBodyAsText());
            }
            catch (error) {
                return null;
            }
        }
        return null;
    }
    /**
     * @return {?}
     */
    toMetadata() {
        /** @type {?} */
        const xml = this.getBodyAsText();
        return new Metadata(xml);
    }
    /**
     * @template T
     * @param {?=} type
     * @return {?}
     */
    toEntitySet(type) {
        /** @type {?} */
        const json = this.getBodyAsJson();
        if (Utils.isNotNullNorUndefined(json) && json.hasOwnProperty(ODataResponse.VALUE)) {
            /** @type {?} */
            let count = null;
            if (json.hasOwnProperty(ODataResponse.ODATA_COUNT)) {
                count = json[ODataResponse.ODATA_COUNT];
            }
            return new EntitySet(json[ODataResponse.VALUE], count, type);
        }
        return null;
    }
    /**
     * @template T
     * @param {?=} type
     * @return {?}
     */
    toComplexCollection(type) {
        /** @type {?} */
        const json = this.getBodyAsJson();
        if (Utils.isNotNullNorUndefined(json) && json.hasOwnProperty(ODataResponse.VALUE)) {
            /** @type {?} */
            const res = [];
            for (const object of json[ODataResponse.VALUE]) {
                res.push(this.toObject(object, type));
            }
            return res;
        }
        return null;
    }
    /**
     * @template T
     * @param {?=} type
     * @return {?}
     */
    toEntity(type) {
        /** @type {?} */
        const json = this.getBodyAsJson();
        return this.toObject(json, type);
    }
    /**
     * @template T
     * @param {?=} type
     * @return {?}
     */
    toComplexValue(type) {
        /** @type {?} */
        const json = this.getBodyAsJson();
        return this.toObject(json, type);
    }
    /**
     * @template T
     * @return {?}
     */
    toPropertyValue() {
        /** @type {?} */
        const json = this.getBodyAsJson();
        if (Utils.isNotNullNorUndefined(json)) {
            if (json.hasOwnProperty(ODataResponse.VALUE)) {
                return /** @type {?} */ (json[ODataResponse.VALUE]);
            }
            return null;
        }
        else {
            return /** @type {?} */ (JSON.parse(this.getBodyAsText()));
        }
    }
    /**
     * @return {?}
     */
    toCount() {
        return Number(this.getBodyAsText());
    }
    /**
     * @return {?}
     */
    toODataResponseBatch() {
        return new ODataResponseBatch(this.getHttpResponse());
    }
    /**
     * @template T
     * @param {?} object
     * @param {?} type
     * @return {?}
     */
    toObject(object, type) {
        if (Utils.isNotNullNorUndefined(object)) {
            if (Utils.isNullOrUndefined(type)) {
                return Object.assign({}, object);
            }
            else {
                return Object.assign(new type(), object);
            }
        }
        return null;
    }
}
ODataResponse.VALUE = 'value';
ODataResponse.ODATA_COUNT = '@odata.count';
if (false) {
    /** @type {?} */
    ODataResponse.VALUE;
    /** @type {?} */
    ODataResponse.ODATA_COUNT;
}

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoib2RhdGEtcmVzcG9uc2UuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9vZGF0YS12NC1uZy8iLCJzb3VyY2VzIjpbImxpYi9vZGF0YS1yZXNwb25zZS9vZGF0YS1yZXNwb25zZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7O0FBRUEsT0FBTyxFQUFFLEtBQUssRUFBRSxNQUFNLGdCQUFnQixDQUFDO0FBQ3ZDLE9BQU8sRUFBRSxTQUFTLEVBQUUsTUFBTSxxQkFBcUIsQ0FBQztBQUNoRCxPQUFPLEVBQUUsUUFBUSxFQUFFLE1BQU0sWUFBWSxDQUFDO0FBQ3RDLE9BQU8sRUFBRSxxQkFBcUIsRUFBRSxNQUFNLDJCQUEyQixDQUFDO0FBQ2xFLE9BQU8sRUFBRSxrQkFBa0IsRUFBRSxNQUFNLHdCQUF3QixDQUFDO0FBRTVELE1BQU0sb0JBQXFCLFNBQVEscUJBQXFCOzs7O0lBSXBELFlBQVksWUFBa0M7UUFDMUMsS0FBSyxDQUFDLFlBQVksQ0FBQyxDQUFDO0tBQ3ZCOzs7O0lBRUQsYUFBYTs7UUFDVCxNQUFNLFdBQVcsR0FBVyxJQUFJLENBQUMsZUFBZSxFQUFFLENBQUMsT0FBTyxDQUFDLEdBQUcsQ0FBQyxjQUFjLENBQUMsQ0FBQztRQUMvRSxFQUFFLENBQUMsQ0FBQyxLQUFLLENBQUMscUJBQXFCLENBQUMsV0FBVyxDQUFDLElBQUksV0FBVyxDQUFDLFFBQVEsQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLENBQUM7WUFDM0UsSUFBSSxDQUFDO2dCQUNELE1BQU0sQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxhQUFhLEVBQUUsQ0FBQyxDQUFDO2FBQzNDO1lBQUMsS0FBSyxDQUFDLENBQUMsS0FBSyxFQUFFLENBQUM7Z0JBQ2IsTUFBTSxDQUFDLElBQUksQ0FBQzthQUNmO1NBQ0o7UUFDRCxNQUFNLENBQUMsSUFBSSxDQUFDO0tBQ2Y7Ozs7SUFFRCxVQUFVOztRQUNOLE1BQU0sR0FBRyxHQUFXLElBQUksQ0FBQyxhQUFhLEVBQUUsQ0FBQztR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Ozs7Ozs7O0lBRVMsUUFBUSxDQUFJLE1BQVcsRUFBRSxJQUFtQjtRQUNsRCxFQUFFLENBQUMsQ0FBQyxLQUFLLENBQUMscUJBQXFCLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxDQUFDO1lBQ3RDLEVBQUUsQ0FBQyxDQUFDLEtBQUssQ0FBQyxpQkFBaUIsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUM7Z0JBQ2hDLE1BQU0sQ0FBQyxNQUFNLENBQUMsTUFBTSxDQUFDLEVBQUUsRUFBRSxNQUFNLENBQUMsQ0FBQzthQUNwQztZQUFDLElBQUksQ0FBQyxDQUFDO2dCQUNKLE1BQU0sQ0FBQyxNQUFNLENBQUMsTUFBTSxDQUFDLElBQUksSUFBSSxFQUFFLEVBQUUsTUFBTSxDQUFDLENBQUM7YUFDNUM7U0FDSjtRQUNELE1BQU0sQ0FBQyxJQUFJLENBQUM7S0FDZjs7c0JBekYrQixPQUFPOzRCQUNELGNBQWMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBIdHRwUmVzcG9uc2UgfSBmcm9tICdAYW5ndWxhci9jb21tb24vaHR0cCc7XG5cbmltcG9ydCB7IFV0aWxzIH0gZnJvbSAnLi4vdXRpbHMvdXRpbHMnO1xuaW1wb3J0IHsgRW50aXR5U2V0IH0gZnJvbSAnLi9lbnRpdHktY29sbGVjdGlvbic7XG5pbXBvcnQgeyBNZXRhZGF0YSB9IGZyb20gJy4vbWV0YWRhdGEnO1xuaW1wb3J0IHsgT0RhdGFSZXNwb25zZUFic3RyYWN0IH0gZnJvbSAnLi9vZGF0YS1yZXNwb25zZS1hYnN0cmFjdCc7XG5pbXBvcnQgeyBPRGF0YVJlc3BvbnNlQmF0Y2ggfSBmcm9tICcuL29kYXRhLXJlc3BvbnNlLWJhdGNoJztcblxuZXhwb3J0IGNsYXNzIE9EYXRhUmVzcG9uc2UgZXh0ZW5kcyBPRGF0YVJlc3BvbnNlQWJzdHJhY3Qge1xuICAgIHByaXZhdGUgc3RhdGljIHJlYWRvbmx5IFZBTFVFID0gJ3ZhbHVlJztcbiAgICBwcml2YXRlIHN0YXRpYyByZWFkb25seSBPREFUQV9DT1VOVCA9ICdAb2RhdGEuY291bnQnO1xuXG4gICAgY29uc3RydWN0b3IoaHR0cFJlc3BvbnNlOiBIdHRwUmVzcG9uc2U8c3RyaW5nPikge1xuICAgICAgICBzdXBlcihodHRwUmVzcG9uc2UpO1xuICAgIH1cblxuICAgIGdldEJvZHlBc0pzb24oKTogYW55IHtcbiAgICAgICAgY29uc3QgY29udGVudFR5cGU6IHN0cmluZyA9IHRoaXMuZ2V0SHR0cFJlc3BvbnNlKCkuaGVhZGVycy5nZXQoJ0NvbnRlbnQtVHlwZScpO1xuICAgICAgICBpZiAoVXRpbHMuaXNOb3ROdWxsTm9yVW5kZWZpbmVkKGNvbnRlbnRUeXBlKSAmJiBjb250ZW50VHlwZS5pbmNsdWRlcygnanNvbicpKSB7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIHJldHVybiBKU09OLnBhcnNlKHRoaXMuZ2V0Qm9keUFzVGV4dCgpKTtcbiAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuXG4gICAgdG9NZXRhZGF0YSgpOiBNZXRhZGF0YSB7XG4gICAgICAgIGNvbnN0IHhtbDogc3RyaW5nID0gdGhpcy5nZXRCb2R5QXNUZXh0KCk7XG4gICAgICAgIHJldHVybiBuZXcgTWV0YWRhdGEoeG1sKTtcbiAgICB9XG5cbiAgICB0b0VudGl0eVNldDxUPih0eXBlPzogKG5ldyAoKSA9PiBUKSk6IEVudGl0eVNldDxUPiB7XG4gICAgICAgIGNvbnN0IGpzb246IGFueSA9IHRoaXMuZ2V0Qm9keUFzSnNvbigpO1xuICAgICAgICBpZiAoVXRpbHMuaXNOb3ROdWxsTm9yVW5kZWZpbmVkKGpzb24pICYmIGpzb24uaGFzT3duUHJvcGVydHkoT0RhdGFSZXNwb25zZS5WQUxVRSkpIHtcbiAgICAgICAgICAgIGxldCBjb3VudDogbnVtYmVyID0gbnVsbDtcbiAgICAgICAgICAgIGlmIChqc29uLmhhc093blByb3BlcnR5KE9EYXRhUmVzcG9uc2UuT0RBVEFfQ09VTlQpKSB7XG4gICAgICAgICAgICAgICAgY291bnQgPSBqc29uW09EYXRhUmVzcG9uc2UuT0RBVEFfQ09VTlRdO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIG5ldyBFbnRpdHlTZXQ8VD4oanNvbltPRGF0YVJlc3BvbnNlLlZBTFVFXSwgY291bnQsIHR5cGUpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH1cblxuICAgIHRvQ29tcGxleENvbGxlY3Rpb248VD4odHlwZT86IChuZXcgKCkgPT4gVCkpOiBUW10ge1xuICAgICAgICBjb25zdCBqc29uOiBhbnkgPSB0aGlzLmdldEJvZHlBc0pzb24oKTtcblxuICAgICAgICBpZiAoVXRpbHMuaXNOb3ROdWxsTm9yVW5kZWZpbmVkKGpzb24pICYmIGpzb24uaGFzT3duUHJvcGVydHkoT0RhdGFSZXNwb25zZS5WQUxVRSkpIHtcbiAgICAgICAgICAgIGNvbnN0IHJlczogVFtdID0gW107XG4gICAgICAgICAgICBmb3IgKGNvbnN0IG9iamVjdCBvZiBqc29uW09EYXRhUmVzcG9uc2UuVkFMVUVdKSB7XG4gICAgICAgICAgICAgICAgcmVzLnB1c2godGhpcy50b09iamVjdDxUPihvYmplY3QsIHR5cGUpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiByZXM7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG5cbiAgICB0b0VudGl0eTxUPih0eXBlPzogKG5ldyAoKSA9PiBUKSk6IFQge1xuICAgICAgICBjb25zdCBqc29uOiBhbnkgPSB0aGlzLmdldEJvZHlBc0pzb24oKTtcbiAgICAgICAgcmV0dXJuIHRoaXMudG9PYmplY3Q8VD4oanNvbiwgdHlwZSk7XG4gICAgfVxuXG4gICAgdG9Db21wbGV4VmFsdWU8VD4odHlwZT86IChuZXcgKCkgPT4gVCkpOiBUIHtcbiAgICAgICAgY29uc3QganNvbjogYW55ID0gdGhpcy5nZXRCb2R5QXNKc29uKCk7XG4gICAgICAgIHJldHVybiB0aGlzLnRvT2JqZWN0PFQ+KGpzb24sIHR5cGUpO1xuICAgIH1cblxuICAgIHRvUHJvcGVydHlWYWx1ZTxUPigpOiBUIHtcbiAgICAgICAgY29uc3QganNvbjogYW55ID0gdGhpcy5nZXRCb2R5QXNKc29uKCk7XG4gICAgICAgIGlmIChVdGlscy5pc05vdE51bGxOb3JVbmRlZmluZWQoanNvbikpIHtcbiAgICAgICAgICAgIGlmIChqc29uLmhhc093blByb3BlcnR5KE9EYXRhUmVzcG9uc2UuVkFMVUUpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIDxUPmpzb25bT0RhdGFSZXNwb25zZS5WQUxVRV07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiA8VD5KU09OLnBhcnNlKHRoaXMuZ2V0Qm9keUFzVGV4dCgpKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHRvQ291bnQoKTogbnVtYmVyIHtcbiAgICAgICAgcmV0dXJuIE51bWJlcih0aGlzLmdldEJvZHlBc1RleHQoKSk7XG4gICAgfVxuXG4gICAgdG9PRGF0YVJlc3BvbnNlQmF0Y2goKTogT0RhdGFSZXNwb25zZUJhdGNoIHtcbiAgICAgICAgcmV0dXJuIG5ldyBPRGF0YVJlc3BvbnNlQmF0Y2godGhpcy5nZXRIdHRwUmVzcG9uc2UoKSk7XG4gICAgfVxuXG4gICAgcHJvdGVjdGVkIHRvT2JqZWN0PFQ+KG9iamVjdDogYW55LCB0eXBlOiAobmV3ICgpID0+IFQpKTogVCB7XG4gICAgICAgIGlmIChVdGlscy5pc05vdE51bGxOb3JVbmRlZmluZWQob2JqZWN0KSkge1xuICAgICAgICAgICAgaWYgKFV0aWxzLmlzTnVsbE9yVW5kZWZpbmVkKHR5cGUpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIE9iamVjdC5hc3NpZ24oe30sIG9iamVjdCk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHJldHVybiBPYmplY3QuYXNzaWduKG5ldyB0eXBlKCksIG9iamVjdCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxufVxuIl19